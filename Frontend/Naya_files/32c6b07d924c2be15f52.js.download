(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{1191:function(t,e,a){"use strict";a.r(e);var n=a(96),s=a(95),o=a.n(s);function i(){var t=Object(n.a)(["\n            mutation loginUser($username: String!, $password: String!) {\n              loginUser(username: $username, password: $password) {\n                authorization\n                user {\n                  name\n                  activated\n                  username\n                  level\n                  image {\n                    hash\n                  }\n                }\n              }\n            }\n          "]);return i=function(){return t},t}var r={props:{},data:function(){return{title:"Login Form",loginData:{},prevRoute:null,isLoading:!1,error:null}},head:function(){return{title:"Login at Naya",meta:[{hid:"description",name:"description",content:"Login into naya for naya experience"}]}},beforeRouteEnter:function(t,e,a){a((function(t){t.prevRoute=e}))},methods:{login:function(){var t=this;this.isLoading=!0;var e=this.loginData;this.$apollo.mutate({mutation:o()(i()),variables:e}).then((function(e){t.$cookies.set("apollo-token",e.data.loginUser.authorization,{path:"/",maxAge:2592e3}),localStorage.setItem("authtoken",e.data.loginUser.authorization),localStorage.setItem("username",e.data.loginUser.user.username),localStorage.setItem("userLoggedIn",1),t.$cookies.set("user",e.data.loginUser.user,{path:"/",maxAge:2592e3});localStorage.getItem("authtoken");t.$store.commit("setToken",e.data.loginUser.authorization);var a=e.data.loginUser.user;t.$store.commit("setUser",a),e.data.loginUser.user.image&&null!=e.data.loginUser.user.image&&(t.$store.commit("setProfileImage",e.data.loginUser.user.image.hash),t.$cookies.set("profileImageHash",e.data.loginUser.user.image.hash,{path:"/",maxAge:2592e3})),t.isLoading=!1,t.$route.query.redirect_uri?window.location.href=t.$route.query.redirect_uri:t.$router.back()})).catch((function(e){t.isLoading=!1,"GraphQL error: invalid password"==e.message?t.error="Incorrect password":"GraphQL error: activation required"==e.message?t.$router.push({name:"activation",query:{username:t.loginData.username}}):e.message&&-1!==e.message.indexOf("you are already logged in")?t.$snackbar.open({message:"Seems like you are already logged in to Naya. Refresh page?",type:"is-warning",position:"is-top",actionText:"OK",indefinite:!0,onAction:function(){location.reload()}}):t.error="Username or Password incorrect"}))}},beforeMount:function(){this.$store.state.user&&this.$router.push({name:"index"})},mounted:function(){},components:{"app-logo":a(285).a}},l=(a(342),a(22)),c=Object(l.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("section",{staticClass:"hero is-fullheight"},[a("div",{staticClass:"hero-body"},[a("div",{staticClass:"container"},[a("div",{staticClass:"form account has-text-left"},[a("app-logo",{staticClass:"margin-bottom-50-px has-text-centered"}),t._v(" "),a("div",{staticClass:"account-input"},[a("b-input",{attrs:{maxlength:"50",placeholder:"username",required:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.loginData.username,callback:function(e){t.$set(t.loginData,"username",e)},expression:"loginData.username"}}),t._v(" "),a("b-input",{staticClass:"inline border-bottom",attrs:{type:"password",placeholder:"password",required:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.loginData.password,callback:function(e){t.$set(t.loginData,"password",e)},expression:"loginData.password"}}),t._v(" "),a("p",{staticClass:"has-text-right"},[a("router-link",{staticClass:"is-size-7 has-text-link",attrs:{to:{name:"forgotpassword"}}},[t._v("Forgot password?")])],1)],1),t._v(" "),a("div",[null!=t.error?a("span",{staticClass:"is-size-7 has-text-danger"},[t._v(t._s(t.error))]):t._e(),t._v(" "),a("p",{staticClass:"has-text-centered margin-top-20-px"},[a("button",{staticClass:"button is-rounded",class:t.isLoading?"is-loading":"",on:{click:t.login}},[t._v("Login")])])]),t._v(" "),a("p",{staticClass:"is-size-7 has-text-centered margin-top-20-px"},[a("nuxt-link",{staticClass:"has-text-grey",attrs:{to:{name:"register"}}},[t._v("Don't have a\n                     "),a("b",[t._v("naya.com.np")]),t._v(" account?\n                     "),a("br"),t._v(" "),a("span",{staticClass:"has-text-primary"},[t._v("Register here")])])],1)],1)])])])])}),[],!1,null,"7f9ae05b",null);e.default=c.exports},285:function(t,e,a){"use strict";a(97),a(153),a(154),a(47);var n=a(96),s=a(95),o=a.n(s);function i(){var t=Object(n.a)(["\n                     mutation analytics {\n                     analytics {\n                        success\n                     }\n                     }\n                  "]);return i=function(){return t},t}var r={props:["header","domain"],data:function(){return{server:"https://api.naya.com.np/",local:"https://naya.com.np/"}},methods:{analytics:function(){this.$apollo.mutate({mutation:o()(i()),context:{headers:{nayahash:this.$cookies.get("nayahash")}}}).then((function(t){})).catch((function(t){}))}},mounted:function(){var t=this;if(null==this.$cookies.get("nayahash")){var e=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}();this.$cookies.set("nayahash",e,{path:"/",maxAge:2592e3})}setTimeout((function(){t.analytics()}),2e3)}},l=a(22),c=Object(l.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.header&&t.domain?a("a",{staticClass:"navbar-item naya-logo",attrs:{href:t.local}},[t._m(0)]):t.header?a("nuxt-link",{staticClass:"navbar-item naya-logo",attrs:{to:{name:"index"}}},[a("span",{staticClass:"logo"},[t._v("\n      n"),a("span",{staticClass:"is-hidden-mobile"},[t._v("aya")])])]):a("div",{staticClass:"naya-logo"},[a("nuxt-link",{attrs:{to:{name:"index"}}},[a("span",{staticClass:"logo"},[t._v("naya")])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"logo"},[this._v("\n      n"),e("span",{staticClass:"is-hidden-mobile"},[this._v("aya")])])}],!1,null,null,null);e.a=c.exports},299:function(t,e,a){},342:function(t,e,a){"use strict";var n=a(299);a.n(n).a}}]);